{% extends "base.html" %}

{% block conteudo %}

<h1>{{ titulo }}</h1>

<form method="GET" class="row g-3 mb-4">

    <div class="col-md-3">
        <label class="form-label">Usuário</label>
        <input type="text" name="usuario" class="form-control" value="{{ request.args.get('usuario','') }}">
    </div>

    <div class="col-md-3">
        <label class="form-label">Tipo de Operação</label>
        <input type="text" name="tipo" class="form-control" value="{{ request.args.get('tipo','') }}">
    </div>

    <div class="col-md-2">
        <label class="form-label">Data Início</label>
        <input type="date" name="data_inicio" class="form-control" value="{{ request.args.get('data_inicio','') }}">
    </div>

    <div class="col-md-2">
        <label class="form-label">Data Fim</label>
        <input type="date" name="data_fim" class="form-control" value="{{ request.args.get('data_fim','') }}">
    </div>

    <div class="col-md-2 d-flex align-items-end">
        <button class="btn btn-primary w-100">Filtrar</button>
    </div>
</form>

<div class="mb-3">
    <a href="{{ url_for('logs.exportar_logs') }}" class="btn btn-success">Exportar CSV</a>
    <a href="{{ url_for('logs.exportar_logs_json') }}" class="btn btn-secondary">Exportar JSON</a>
</div>


<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>ID</th>
            <th>Data/Hora</th>
            <th>Usuário</th>
            <th>Perfil</th>
            <th>Operação</th>
            <th>Modelo</th>
            <th>Descrição</th>
            <th>Modificações</th>
        </tr>
    </thead>

    <tbody>
        {% for log in logs %}
        <tr>
            <td>{{ log.id }}</td>
            <td>{{ log.horario_brasil.strftime("%d/%m/%Y %H:%M:%S") }}</td>
            <td>{{ log.usuario_nome }}</td>
            <td>{{ log.usuario_perfil }}</td>
            <td>{{ log.tipo_operacao }}</td>
            <td>{{ log.tipo_modelo }}</td>
            <td>{{ log.descricao }}</td>
            <td><pre>{{ log.modificacoes }}</pre></td>
        </tr>
        {% else %}
        <tr>
            <td colspan="8" class="text-center">Nenhum log encontrado.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
